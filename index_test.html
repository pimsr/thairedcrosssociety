<!DOCTYPE html>
<html lang="en">
<head>
  <title>The Thai Red Cross Society: สภากาชาดไทย</title>

  <meta charset="utf-8">
  <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
  <meta name="description" content="">
  <meta name="HandheldFriendly" content="true">

  <!-- Google Fonts -->
  <!-- <link href='https://fonts.googleapis.com/css?family=Kanit:300,400,500,700" rel="stylesheet'> -->


  <!-- Css -->
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/css.css">
  <link rel="stylesheet" href="css/responsive.css">
  <link rel="stylesheet" href="css/animate.css">
  <!-- <link rel="stylesheet" href="css/embla.css"> -->

  <!-- Favicons -->
  <!-- <link rel="shortcut icon" href="img/favicon.ico">
  <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png"> -->

  <!-- Lazyload (must be placed in head in order to work) -->
</head>
<!-- oncontextmenu="return false;" -->
<body style="touch-action: none;" >

    <div class="content-wrapper">
        <div id="app" class="main-content">
            <div id="page1">
                <div class="bg-tmp" >
                   
                    <img src="images/bg-01.jpg" />
                </div>
                <div class="logo-wrapper">
                    <div id="logo">
                    
                    </div>

                </div>
                <a href="#" class="title-home">แตะเพื่อเริ่มใช้งาน</a>
            </div>
            <!-- PAGE 2-->
            <div id="page2">
                <div class="bg-tmp">
                    <img src="images/bg-01.jpg" />
                </div>
                <div class="logo-wrapper small">
                    <img src="images/logo.svg" />
                </div>
                
                <div class="form-wrapper">
                    <div class="wrapper">
                        <div class="form-group">
                            <label>ชื่อ</label>
                            <input name="fname" class="req fname" onkeyup="keyupFunction()"/>
                        </div>
                        <div class="form-group">
                            <label>นามสกุล</label>
                            <input name="sname" class="req sname" onkeyup="keyupFunction()"/>
                        </div>
                    </div>
                </div>
                <div class="line-img">
                    <img src="images/line-graphic.svg" />
                </div>
                
                <div class="btn-wrapper">
                    <button class="btn1">ยกเลิก</button>
                    <button class="btn2" disabled>ถัดไป</button>
                </div>
            </div>

            <!-- PAGE 3-->
            <div id="page3">
                <div class="bg-tmp">
                    <img src="images/bg.png" />
                </div>
                <div class="logo-wrapper right">
                    <img src="images/logo.svg" />
                </div>
                
                <p>
                    สืบสานปณิธานการให้ที่งดงาม<br>
                    ข้าพเจ้าตั้งปณิธานว่า
                </p>
                <div class="line-img">
                    <img src="images/line-graphic.svg" />
                </div>

                <div class="select-word">
                    <div class="wrapper">
                        <div class="radio-text">
                            <label class="container">
                                <input value="1" name="word" type="radio" id="req_text_w1" class="req_text" onclick="keyupTextFunction()">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="text" id="text1">
                            ข้าพเจ้าจะทำตัวเป็นประชาชนคนไทยที่ดี <br>
                            ด้วยการคอยช่วยเหลือผู้อื่นอยู่เสมอ<br>
                            โดยเฉพาะผู้ที่ตกทุกข์ได้ยากและผู้ที่กำลังเดือนร้อน
                        </div>
                    </div>

                    <div class="wrapper">
                        <div class="radio-text">
                            <label class="container">
                                <input value="2" name="word" type="radio" id="req_text_w2" class="req_text" onclick="keyupTextFunction()">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="text" id="text2">
                            ข้าพเจ้าจะทำตัวให้เกิดประโยชน์แก่สังคม<br>
                            และ ประเทศชาติ<br>
                            ด้วยการคิดดี ทำดี ประพฤติ และ ปฎิบัติตัวเป็นคนดี
                        </div>
                    </div>
                </div>

                <div class="line-img">
                    <img src="images/line-graphic.svg" />
                </div>

                <div class="textarea-wrapper">
                    <label>พิมพ์ข้อความ คำมั่นสัญญา (0/30)</label>
                    <textarea align="left" class="req_text1" id="req_text_w3" onkeyup="keyupTextFunction()"></textarea>
                </div>

                <h3>ขอพระองค์ทรงพระเจริญยิ่งยืนนาน</h3>
                
                <div class="btn-wrapper">
                    <button class="btn1">ยกเลิก</button>
                    <button class="btn2" disabled>ถัดไป</button>
                </div>
            </div>

            <!-- PAGE 4-->
            <div id="page4">
                <div class="bg-tmp">
                    <img src="images/bg-new.png" />
                </div>
                <div class="bg-tmp active">
                    <img src="images/bg-showephoto.png" />
                </div>
                <div class="logo-wrapper small">
                    <img src="images/logo.svg" />
                </div>
                <div class="image-take">
                    <div>
                        <video id="video" width="500" height="640" autoplay></video>
                        <div>
                            <canvas id="canvas_camera" width="500" height="640"></canvas>
                        </div>
                        
                        <!-- <img src="images/bg-take-photo.png" alt=""> -->
                    </div>
                </div>
                <div class="image-take-image">
                    <div class="text" id="text">
                        ข้าพเจ้าจะทำตัวให้เกิดประโยชน์แก่สังคม
                        และ ประเทศชาติ
                        ด้วยการคิดดี ทำดี ประพฤติ และ ปฎิบัติตัวเป็นคนดี
                    </div>
                    <div class="img">
                        <img src="images/bg-bt.png" alt="">
                    </div>
                
                    <div class="btn-wrapper">
                        <button class="btn1">ย้อนกลับ</button>
                        <button class="btn2">ลงนามถวายพระพร</button>
                    </div>
                </div>
                <div class="btn-camera" id="snap">
                    <img src="images/icon-camera.png" alt="">
                </div>
            </div>

            <!-- PAGE 5-->
            <!-- <div id="page5">
                <div class="logo-wrapper small">
                    <img src="images/logo.svg" />
                </div>
                <div class="image-take">
                    <div>
                        <img src="images/bg-photo.png" alt="">
                    </div>
                    <div class="text" id="text">
                        ข้าพเจ้าจะทำตัวให้เกิดประโยชน์แก่สังคม
                        และ ประเทศชาติ
                        ด้วยการคิดดี ทำดี ประพฤติ และ ปฎิบัติตัวเป็นคนดี
                    </div>
                    <div class="img">
                        <img src="images/bg-bt.png" alt="">
                    </div>
                </div>
                <div class="btn-wrapper">
                    <button class="btn1">ย้อนกลับ</button>
                    <button class="btn2">ลงนามถวายพระพร</button>
                </div>
            </div> -->

            <!-- PAGE 6-->
            <div id="page6">
                <div class="logo-wrapper small">
                    <img src="images/logo.svg" />
                </div>
                <div class="image-take">
                    คุณได้ลงนามถวายพระพรเรียบร้อยแล้ว
                </div>
                <div class="btn-wrapper">
                    <button class="btn1">ตกลง</button>
                </div>
            </div>
        </div>

        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <!-- <div class="firefly"></div> -->
        
    </div>

    <!-- jQuery Scripts -->
    <!-- <script src="js/jquery.min.js"></script> -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="js/custom.js"></script>
    <script src="js/lottie.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/jquery.drawsvg/1/jquery.drawsvg.min.js"></script>

    <!-- <script src="https://unpkg.com/embla-carousel" type="text/javascript"></script> -->

    <script type="text/javascript">

        var animation = bodymovin.loadAnimation({
            container: document.getElementById('logo'), // Required
            path: "js/yensira-logo.json", // Required
            renderer: 'svg', // Required
            loop: true, // Optional
            autoplay: true, // Optional
            name: "animate", // Name for future reference. Optional.
        })
        animation.setSpeed(0.8);
        $("#page2").hide();
        $("#page3").hide();
        $("#page4").hide();
        $("#page5").hide();
        $("#page6").hide();
        $(".image-take-image").hide();
        $("#page1 .title-home").click(function () {
            $("#page1").hide();
            $("#page2").show();
        });

        $("#page2 .btn2").click(function () {
            $("#page2").hide();
            $("#page3").show();
        });

         $("#page2 .btn1").click(function () {
            $("#page2").hide();
            $("#page1").show();
        });

        $("#page3 .btn2").click(function () {
            $("#page2").hide();
            $("#page3").hide();
            $("#page4").show();

              // Grab elements, create settings, etc.
            var video = document.getElementById('video');
                console.log("mediaDevicesd");

            // Get access to the camera!
            if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                console.log("mediaDevices");
                var constraints = { 
                        video: { 
                            width: 500, 
                            height: 640,
                            facingMode: 'user'
                            } 
                        }; 

                // Not adding `{ audio: true }` since we only want video now
                navigator.mediaDevices.getUserMedia(constraints).then(function(stream) {
                    //video.src = window.URL.createObjectURL(stream);
                    video.srcObject = stream;
                    video.setAttribute('autoplay', '');
                    video.setAttribute('muted', '');
                    video.setAttribute('playsinline', '');
                    video.play();
                });
            }
                var canvas = document.getElementById('canvas_camera');
                var context = canvas.getContext('2d');
                var video = document.getElementById('video');
                // var img = new Image();
                // Trigger photo take
                document.getElementById("snap").addEventListener("click", function () {
                    canvas.toBlob(function (blob) {
                        var newImg = document.createElement('img'),
                            url = URL.createObjectURL(blob);

                            console.log("url", url);
                            

                        newImg.onload = function () {
                            // no longer need to read the blob so it's revoked
                            URL.revokeObjectURL(url);
                        };

                        newImg.src = url;
                        console.log("newImg", newImg);
                        
                        // document.body.appendChild(newImg);
                    });
                    
                    context.drawImage(video, 0, 0, 500, 640);

                    if ($("input[name='word']").is(':checked')) {
                        var value =$("input[name='word']").val();
                        if(+value === +1) {
                            document.getElementById("text").innerHTML = document.getElementById("text1").innerHTML;
                        } else {
                            document.getElementById("text").innerHTML = document.getElementById("text2").innerHTML;
                        }   
                    }
                    else {
                        if(document.getElementById("req_text_w3").value !== "") {
                            document.getElementById("text").innerHTML =document.getElementById("req_text_w3").value;
                        }
                    }
                    $(".image-take-image").show();
                    $(".image-take").addClass("active");
                    $("#video").hide()
                    $("#snap").hide()
                })
        });

        

        $("#page3 .btn1").click(function () {
            $("#page2").show();
            $("#page3").hide();
            $("#page4").hide();
            
        });

        $("#page4 .btn1").click(function () {
            $("#page1").hide();
            $("#page2").hide();
            $("#page3").hide();
            $("#page4").show();
            $("#video").show()
            $(".image-take-image").hide()
            $("#snap").show()
            $("#page5").hide();
            $("#page5").hide();
        });

        $("#page4 .image-take-image .btn2").click(function () {
            $("#page2").hide();
            $("#page3").hide();
            $("#page4").hide();
            $("#page5").hide();
            $("#page6").show();
            var blessing= ""
            if($("input[name='word']").val() !== "") {
                if (+$("input[name='word']").val() === +1) {
                    blessing = document.getElementById("text1").innerHTML;
                } else {
                    blessing = document.getElementById("text2").innerHTML;
                } 
                // blessing = $("input[name='word']").val()
            } else {
                blessing = $('textarea').val()
            }

            var name = $('.fname').val() + " " + $('.sname').val()
            var value = { 
                "name": name, 
                "image": "ssss",
                "blessing": blessing
            }

            $.ajax({
                url: "https://www.yensira.com/api/member/add",
                type: "POST",
                dataType: "application/json",
                data: JSON.stringify(value),
                headers: { 
                    "access-token": "7223c5d5418d992b82432b516f9ac1c4d32a64b44852c0b3731aa5a87b97db34" 
                },
                success: function (data) {
                    console.log("data", data);
                    
                }
            });
        });

        $("#page6 .btn1").click(function () {
            $(':input').val('');
            $('textarea').val('');
            $(".textarea-wrapper label").show();
            // $(this).css("padding-top", "40px");
            $("input[name='word']").prop("checked", false);
            $("#page3 .btn2").prop("disabled", true);
            $("#video").show()
            $(".image-take-image").hide()
            $("#snap").show()
            $("#page1").show();
            $("#page2").hide();
            $("#page3").hide();
            $("#page4").hide();
            $("#page5").hide();
            $("#page6").hide();
        });

        $("#req_text_w3").on("keydown", function (e) {
            $(".textarea-wrapper label").hide();
            $(this).css("padding-top", "15px");
            $("input[name='word']").prop("checked", false);
            
        });

        $("input[name='word']").click(function () {
            $("#req_text_w3").val('');
            $(".textarea-wrapper label").show();
            $(this).css("padding-top", "40px");
        });    

        // function keyupFunction() {
        //     var inputValidate = true;

        //     $(".req").each(function (index, element) {
        //         if ($(element).val() == "")
        //             inputValidate = false;
        //     });

        //     if (inputValidate)
        //         $("#page2 .btn2").prop("disabled", false);
        //     else
        //         $("#page2 .btn2").prop("disabled", true);
        // }

        function keyupFunction() {
            var inputValidate = true;

            $(".req").each(function (index, element) {
                if ($(element).val() == "")
                    inputValidate = false;
            });

            if (inputValidate)
                $("#page2 .btn2").prop("disabled", false);
            else
                $("#page2 .btn2").prop("disabled", true);
        }

        function keyupTextFunction() {
            var inputValidate = true;

            // $(".textarea-wrapper label").hide();

            $(".req_text").each(function (index, element) {
                if ($(element).val() == "" && $(".req_text1").text === "")
                    inputValidate = false;
            });

            if (inputValidate)
                $("#page3 .btn2").prop("disabled", false);
            else
                $("#page3 .btn2").prop("disabled", true);
        }

        
    </script>

</body>
</html>